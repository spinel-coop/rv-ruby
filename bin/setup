#!/bin/bash
set -euo pipefail
set -x

DIRNAME="$(basename "$(pwd)")"
if brew tap | grep -F "jdx/$DIRNAME"; then
  brew untap "jdx/$DIRNAME" --force
fi
brew tap "jdx/$DIRNAME" .
rm -rf "$(brew --repo)/Library/Taps/jdx/homebrew-$DIRNAME"
ln -sf "$(pwd)" "$(brew --repo)/Library/Taps/jdx/homebrew-$DIRNAME"
